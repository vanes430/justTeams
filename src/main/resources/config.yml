# ===================================================================
#                        JustTeams Configuration
#                    Team Management Plugin Settings
# ===================================================================
#
# This file contains all configuration options for the JustTeams plugin.
# Each setting controls different aspects of team functionality.
#
# Configuration Guidelines:
#   - Boolean values: true/false (lowercase)
#   - Strings: Use quotes "like this" for text values
#   - Numbers: No quotes needed for integers
#   - Colors: Use hex format #RRGGBB
#
# For support and documentation, please visit our wiki.
# Always backup this file before making changes.
#
# ===================================================================

# Configuration version - DO NOT MODIFY
config-version: 22

# ===================================================================
#                         Proxy Configuration
# ===================================================================
#
# Configure cross-server functionality for network setups.
# Supports BungeeCord, Velocity, and Waterfall proxies.
#
proxy_settings:
  # Proxy type selection
  # Options: "NONE", "BUNGEE", "VELOCITY"
  type: "NONE"

# ===================================================================
#                        Database Configuration
# ===================================================================
#
# Choose your preferred storage method for team data.
# H2 is recommended for single servers, MySQL for networks.
#
storage:
  # Database type: "h2", "mysql", "mariadb"
  type: "h2"

  # MySQL/MariaDB Settings
  mysql:
    host: "localhost"
    port: 3306
    database: "username"
    username: "root"
    password: ""
    
    # Connection security
    use_ssl: false
    allow_public_key_retrieval: true
    use_unicode: true
    character_encoding: "utf8mb4"
    collation: "utf8mb4_unicode_ci"
    
    # Connection timeouts (milliseconds)
    connection_timeout: 30000
    socket_timeout: 60000
    auto_reconnect: true
    fail_over_read_only: false
    max_reconnects: 3

    # Connection Pool Settings (Optimized for both H2 and MySQL)
  connection_pool:
    # H2 defaults: max_size=4, min_idle=1
    # MySQL defaults: max_size=10, min_idle=3  
    max_size: 10
    min_idle: 3
    
    # Timeouts in milliseconds
    idle_timeout: 300000          # 5 minutes
    max_lifetime: 1800000         # 30 minutes
    connection_timeout: 30000     # 30 seconds (match MySQL timeout)
    validation_timeout: 5000      # 5 seconds
    
    # Connection testing
    connection_test_query: "SELECT 1"
    
    # Leak detection (0 = disabled, >0 = milliseconds before leak warning)
    leak_detection_threshold: 0

# ===================================================================
#                         Redis Configuration
# ===================================================================
#
# Redis provides instant cross-server messaging (< 100ms latency).
# When enabled, Redis handles real-time updates while MySQL stores data.
# If Redis fails, the plugin automatically falls back to MySQL polling.
#
redis:
  # Enable Redis for instant cross-server communication
  # Set to 'false' to use only MySQL (1-second polling)
  enabled: false
  
  # Redis server connection details
  host: "localhost"
  port: 6379
  
  # Authentication (leave empty if not required)
  password: ""
  
  # SSL/TLS encryption for Redis connection
  use_ssl: false
  
  # Connection timeout in milliseconds
  # Lower values fail faster, higher values tolerate network delays
  timeout: 5000
  
  # Connection pool settings
  pool:
    # Maximum total connections in pool
    max_total: 20
    
    # Maximum idle connections to keep open
    max_idle: 10
    
    # Minimum idle connections to maintain
    min_idle: 2

# ===================================================================
#                        Feature Configuration
# ===================================================================
#
# Enable or disable specific features to customize functionality.
# Each feature can be toggled independently.
#
features:
  # Core Team Management
  team_creation: true
  team_disband: true
  team_invites: true
  team_join_requests: true
  team_blacklist: true
  team_transfer: true
  team_public_toggle: true
  team_rename: true
  
  # Member Management
  member_kick: true
  member_promote: true
  member_demote: true
  member_leave: true
  
  # Information Features
  team_info: true
  team_tag: true
  team_description: true
  team_leaderboard: true
  
  # Home System
  team_home: true
  team_home_set: true
  team_home_teleport: true
  
  # Warp System
  team_warps: false
  team_warp_set: false
  team_warp_delete: false
  team_warp_teleport: false
  
  # PvP Features
  team_pvp: false
  team_pvp_toggle: false
  
  # Economy Features (Requires Vault)
  team_bank: false
  team_bank_deposit: false
  team_bank_withdraw: false
  
  # Storage Features
  team_enderchest: true
  
  # Communication Features
  team_chat: true
  team_message_command: true
  
  # Cross-Server Display
  show_cross_server_status: true

# ===================================================================
#                          General Settings
# ===================================================================
#
# Core plugin settings affecting overall behavior.
#
settings:
  # Debug Options
  debug: false
  
  # Server Configuration
  # single_server_mode: Set to true if you have only ONE server
  #   - Disables cross-server features for better performance
  #   - Use with H2 database for standalone servers
  # Set to false for multi-server networks with MySQL
  single_server_mode: true
  
  # server-identifier: Unique name for this server in your network
  #   - Must be different for each server (e.g., "survival", "creative", "lobby")
  #   - Only used when single_server_mode is false
  #   - Used to track which server players are on
  server-identifier: "survival"
  
  # Theme Colors
  main_color: "#4C9DDE"
  accent_color: "#FFD700"
  currency_format: ""
  
  # Team Limits
  max_team_size: 10
  min_name_length: 3
  max_name_length: 16
  max_tag_length: 6
  max_description_length: 64
  
  allow_formatting_codes: true
  blocked_formatting_codes:
    - "&k"
    - "&l"
    - "&m"
    - "&n"
    - "&o"
  
  rename_cooldown: 604800
  
  # Default Settings
  default_pvp_status: true
  default_public_status: false
  
  # Cross-Server Synchronization
  # IMPORTANT: Enable this for multi-server networks!
  # Requirements:
  #   1. Set single_server_mode to false
  #   2. Use MySQL database (storage.type: "mysql")
  #   3. Configure proxy_settings.type (BUNGEE or VELOCITY)
  #   4. Set unique server-identifier on each server
  #   5. All servers must connect to the SAME MySQL database
  # When enabled:
  #   - Teams are synchronized across all servers
  #   - Players can switch servers and stay in their team
  #   - Team data updates in real-time across the network
  enable_cross_server_sync: false
  
  # Performance Optimization
  # Sync intervals control how often cross-server data is synchronized
  # ULTRA-FAST MODE: critical_sync_interval set to 1 second for near-instant delivery
  # For high-traffic servers (100+ players): increase to 2-3 seconds
  # For normal servers: 1 second provides the best real-time experience
  sync_optimization:
    heartbeat_interval: 600            # Server heartbeat: 10 minutes (600 seconds)
    cross_server_sync_interval: 3    
    critical_sync_interval: 1          # Messages & critical updates: 1 SECOND (ULTRA-FAST)
    max_teams_per_batch: 100
    enable_lazy_loading: true
    team_cache_ttl: 1200
    enable_optimistic_locking: true
    max_sync_retries: 2
    sync_retry_delay: 1000             # Reduced retry delay to 1 second
    max_batch_size: 500
    cache_cleanup_interval: 900
    async_database_operations: true
    bulk_operation_batch_size: 200
    connection_validation_interval: 60
    heartbeat_batch_size: 1
    enable_connection_pooling: true

  # Performance Monitoring
  performance:
    enable_metrics: false
    log_slow_queries: true
    slow_query_threshold: 50
    detailed_sync_logging: false
    monitor_connection_pool: false
    connection_pool_log_interval: 60
    enable_debug_logging: false
    gui_update_throttle_ms: 100
    max_concurrent_db_operations: 5

# ===================================================================
#                        Broadcast Settings
# ===================================================================
#
# Control server-wide announcements for team events.
#
broadcasts:
  team-created: true
  team-disbanded: true

# ===================================================================
#                        Team Chat Settings
# ===================================================================
#
# Configure the team chat system.
# When character_enabled is true, players can prefix messages with the character to send team chat
# Set character to a symbol like "#" or "!" 
# IMPORTANT: Never leave character empty ("") as it will capture ALL messages!
#
team_chat:
  character_enabled: true
  character: "#"  # Use # prefix for team chat (e.g., "#hello team")
  require_space: false  # If true, requires space after character (e.g., "# hello team")

# ===================================================================
#                        Home Configuration
# ===================================================================
#
# Configure team home teleportation system.
#
team_home:
  warmup_seconds: 5
  cooldown_seconds: 300

# ===================================================================
#                        Warp Configuration
# ===================================================================
#
# Configure the team warp system.
#
team_warps:
  max_warps: 5
  warmup_seconds: 5
  cooldown_seconds: 300

# ===================================================================
#                        Bank Configuration
# ===================================================================
#
# Configure the team banking system (requires Vault).
#
team_bank:
  enabled: true
  max_balance: 1000000.0

# ===================================================================
#                     Ender Chest Configuration
# ===================================================================
#
# Configure the shared team ender chest.
#
team_enderchest:
  enabled: false
  rows: 3

# ===================================================================
#                    World Restrictions Configuration
# ===================================================================
#
# Configure per-world feature restrictions.
# Features can be disabled in specific worlds to prevent abuse.
#
# Available features to restrict:
#   - sethome: Prevents setting team home in specified worlds
#   - setwarp: Prevents creating team warps in specified worlds
#   - home: Prevents teleporting to team home from specified worlds
#   - warp: Prevents teleporting to team warps from specified worlds
#   - enderchest: Prevents accessing team ender chest in specified worlds
#   - bank: Prevents using team bank in specified worlds
#
world_restrictions:
  enabled: true
  
  # List of worlds where specific features are disabled
  # Add world names exactly as they appear in your server
  disabled_worlds:
    # Prevent ender chest access in dangerous worlds
    enderchest:
      - "world_nether"
      - "world_the_end"
    # Prevent setting home in PvP/event worlds
    sethome:
      - "pvp_world"
      - "event_world"
    # Prevent creating warps in PvP/event worlds
    setwarp:
      - "pvp_world"
      - "event_world"
    # Prevent teleporting home from PvP/event worlds
    home:
      - "pvp_world"
      - "event_world"
    # Prevent teleporting to warps from PvP worlds
    warp:
      - "pvp_world"
    # Prevent bank access in creative worlds
    bank:
      - "creative_world"

# ===================================================================
#                      Feature Costs Configuration
# ===================================================================
#
# Configure costs for using team features.
# Supports both Vault economy and item-based costs.
#
feature_costs:
  enabled: true
  
  # Economy costs (requires Vault)
  economy:
    enabled: true
    
    # Cost for each feature usage
    sethome: 100.0
    home: 50.0
    enderchest: 25.0
    setwarp: 200.0
    warp: 75.0
    bank_deposit: 0.0
    bank_withdraw: 10.0
    rename: 500.0
  
  # Item costs
  items:
    enabled: false
    
    # Item costs for each feature (format: "MATERIAL:AMOUNT")
    sethome:
      - "DIAMOND:2"
      - "EMERALD:1"
    home:
      - "ENDER_PEARL:1"
    enderchest:
      - "ENDER_CHEST:1"
    setwarp:
      - "DIAMOND:5"
      - "GOLD_INGOT:10"
    warp:
      - "GOLD_INGOT:2"
    
    # Whether to consume items on use (true) or just require them in inventory (false)
    consume_on_use: true

# ===================================================================
#                        Effects Configuration
# ===================================================================
#
# Configure sound and particle effects.
#
effects:
  sounds:
    enabled: true
    
    # General Sounds
    success: "BLOCK_NOTE_BLOCK_PLING"
    error: "BLOCK_NOTE_BLOCK_BASS"
    teleport: "BLOCK_BEACON_ACTIVATE"
    gui_open: "BLOCK_WOODEN_BUTTON_CLICK_ON"
    
    # Event Sounds
    team_created: "ENTITY_PLAYER_LEVELUP"
    team_disbanded: "BLOCK_NOTE_BLOCK_CHIME"
    member_join: "BLOCK_NOTE_BLOCK_HARP"
    member_leave: "BLOCK_NOTE_BLOCK_BELL"
    permission_change: "BLOCK_NOTE_BLOCK_FLUTE"
    warp_created: "BLOCK_NOTE_BLOCK_XYLOPHONE"
    warp_deleted: "BLOCK_NOTE_BLOCK_COW_BELL"
    home_set: "BLOCK_NOTE_BLOCK_GUITAR"
    bank_transaction: "BLOCK_NOTE_BLOCK_BIT"
    
  particles:
    teleport_warmup: "PORTAL"
    teleport_success: "END_ROD"

# ===================================================================
#                      Bedrock Edition Support
# ===================================================================
#
# Configure cross-platform support for Bedrock Edition players.
# Requires Floodgate plugin.
#
bedrock_support:
  enabled: true
  show_platform_indicators: true
  show_gamertags: true
  full_feature_support: true
  cross_platform_teams: true
  uuid_mode: "auto"